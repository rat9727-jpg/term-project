
# 使用 Python 解常微分方程之數值方法比較

## 一、研究背景與目的

常微分方程（Ordinary Differential Equations, ODEs）廣泛應用於數學、物理、工程及自然科學中，用以描述各類動態系統。然而，許多實際問題中的微分方程無法求得解析解，因此必須仰賴數值方法進行近似求解。

本專題使用 Python 實作多種常微分方程數值解法，包括 **Euler 法、改良 Euler 法（Heun 法）與四階 Runge–Kutta 法（RK4）**，並將數值解與解析解進行比較，分析不同數值方法在精度與穩定性上的差異，以加深對數值解微分方程方法的理解。

---

## 二、專題目標

本專題的主要目標如下：

* 使用 Python 實作多種常微分方程的數值解法
* 比較不同數值方法在相同步長下的誤差表現
* 探討步長大小對數值解精度的影響
* 利用圖形視覺化呈現數值解與解析解的差異
* 說明高階數值方法在實際應用上的優勢

---

## 三、數學模型與理論基礎

本專題考慮的一階常微分方程一般形式為：

[
\frac{dy}{dt} = f(t, y)
]

其中選用指數成長方程作為示例：

[
\frac{dy}{dt} = ky
]

其解析解為：

[
y(t) = y_0 e^{kt}
]

該方程常見於族群成長、放射性衰變及工程系統建模等應用。

---

## 四、數值方法介紹

### 4.1 Euler 法

Euler 法為最基本的數值解法，其概念為利用當前點的切線斜率近似下一步的函數值：

[
y_{n+1} = y_n + h f(t_n, y_n)
]

此方法計算簡單，但當步長較大時，誤差容易快速累積。

---

### 4.2 改良 Euler 法（Heun 法）

改良 Euler 法透過取起點與終點斜率的平均值來修正 Euler 法的誤差：

[
y_{n+1} = y_n + \frac{h}{2} \left( f(t_n, y_n) + f(t_{n+1}, y_n + h f(t_n, y_n)) \right)
]

相較於 Euler 法，此方法在精度上有明顯提升。

---

### 4.3 四階 Runge–Kutta 法（RK4）

RK4 為一種高精度的數值方法，透過在每個步長中計算四次斜率進行加權平均：

[
y_{n+1} = y_n + \frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)
]

RK4 方法在保持合理計算成本的情況下，能提供非常準確的數值解。

---

## 五、程式架構說明

```text
ODE_Project/
│── main.py
│── ode_solver.py
│── examples.py
│── README.md
```

### 各檔案功能

* **ode_solver.py**
  實作 Euler 法、改良 Euler 法與 RK4 法等數值解法。

* **examples.py**
  定義微分方程範例與其解析解。

* **main.py**
  主程式，負責設定初始條件、呼叫數值解法並繪製比較圖。

---

## 六、程式執行方式

### 執行環境需求

* Python 3.x
* NumPy
* Matplotlib

### 套件安裝

```bash
pip install numpy matplotlib
```

### 執行指令

在專題資料夾中執行：

```bash
python main.py
```

執行後將顯示數值解與解析解的比較圖。

---

## 七、結果分析與討論

由數值模擬結果可觀察到：

* Euler 法在步長較大時誤差明顯
* 改良 Euler 法可有效降低誤差
* RK4 法在相同步長下具有最佳精度
* 高階數值方法能在較大步長下仍維持良好準確度

上述結果符合數值分析理論，顯示不同方法在精度與計算成本間的取捨。

---

## 八、開發過程說明

本專題先實作 Euler 法作為基礎，並透過測試發現其在精度上的限制，因此逐步加入改良 Euler 法與 RK4 法。透過比較不同方法的數值結果與解析解，加深對數值解微分方程方法的理解。

程式採模組化設計，以提升可讀性與後續擴充性。

---

## 九、AI 工具使用說明

本專題在開發過程中，使用大型語言模型（LLM）作為輔助工具，用於理解數值方法的演算法流程與 Python 語法。實際程式邏輯、參數設定與結果分析皆由本人完成與調整。

---

## 十、參考資料

1. 課堂講義與數值分析相關教材
2. 微分方程相關教科書
3. Python 官方文件（NumPy、Matplotlib）
4. 線上數值分析教學資源

---

## 十一、結論

本專題成功以 Python 實作多種常微分方程的數值解法，並透過比較不同方法的數值結果，驗證高階數值方法在精度上的優勢。此專題展示了數值分析在實際科學與工程問題中的重要性，也加深了對微分方程數值解法的理解。

## generate from chatGPT